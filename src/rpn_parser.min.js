function RPNParser(f,D){function q(d,b){p[d]={};p[d][b]=1}function b(d,c,e,f){if(e instanceof Array)for(var a=0;a<e.length;a++)b(d,c,e[a],f);else c=p[d][c],void 0!==c&&(p[d][e]="string"===typeof c||c instanceof String?c+f+" ":c*f)}function t(d,c,b){if(b instanceof Array)for(var e=0;e<b.length;e++)t(d,c,b[e]);else void 0!==p[d][c]&&(p[d][b]=p[d][c])}function e(d){return 0==m.length?0:(void 0===d?0:d)||!Array.isArray(x())?m.pop():m.pop()[0]}function A(){return 0==m.length?"":""+x()}function x(){return 0==
m.length?0:m[m.length-1]}function c(d){Array.isArray(d)||(d=[d]);m.push(d)}function y(d){return B[d]}function r(d){d=d.split(" ");for(var b="+ - / * % ^ mod".split(" "),n=0;n<d.length;n++){var h=d[n];if(0!=h.length)if(-1!=h.indexOf("..")){var a=parseInt(h.split("..")[0]),g=parseInt(h.split("..")[1]);isNaN(a)&&(a=parseInt(""+y(h.split("..")[0])));isNaN(g)&&(g=parseInt(""+y(h.split("..")[1])));isNaN(a)||isNaN(g)||(c([a,g]),r("seq"))}else if(37==h.charCodeAt(0)&&1!=h.length)a=A(),h=h.substring(1),B[h]=
a;else if(36==h.charCodeAt(0)&&1!=h.length)r(y(h.substring(1)));else{a:{var k=h;if("!"==k)c(f.factorial(e(!0)));else if("rand"==k){a=e(!0);for(g=0;g<a.length;g++)a[g]=Math.floor(1E5*Math.random()%a[g]);c(a)}else if("round"==k)c(f.round(e(!0)));else if("floor"==k)c(f.floor(e(!0)));else if("ceil"==k)c(f.ceil(e(!0)));else if("lcm"==k)c(f.lcm(e(!0),e(!0)));else if("gcd"==k)c(f.gcd(e(!0),e(!0)));else if("pyth"==k)2==x().length&&r("mag");else if("abs"==k)c(f.abs(e(!0)));else if("min"==k||"max"==k){var a=
e(!0),g=a[0],l=f.min;"max"==k&&(l=f.max);for(k=1;k<a.length;k++)g=l(g,a[k]);c(g)}else if("ln"==k)c(f.log(e(!0)));else if("log"==k)c(f.log(e(!0))/f.log(10));else if("acc"==k)g=e(),a=e(!0),c(f.divide(f.round(f.multiply(a,f.pow(10,g))),f.pow(10,g)));else{a=!1;break a}a=!0}if(!a)if(a=h.split("|"),3==a.length&&void 0!==p[a[0]]&&void 0!==p[a[0]][a[1]]&&void 0!==p[a[0]][a[2]]){var g=a[0],l=e(!0),k=a[1],q=a[2],v=p[g][k],a=p[g][q];if(void 0===v||void 0===a)a=0;else if(("string"===typeof v||v instanceof String)&&
("string"===typeof a||a instanceof String)){for(var g=l+" ",l=v,k=" ",l=l.split(" "),v="+ - / * ^ % mod".split(" "),q="-;+;*;/;1 swap / ^;%;mod".split(";"),t=0,u="",w=0;w<l.length;w++)if(0!=l[w].length){var C=v.indexOf(l[w]);-1===C?(t++,u+=l[w]+" "):(1==t?(k=u+q[C]+" "+k,u=""):u+=l[w]+" ",t--)}k=u+k;a=g+k+" "+a}else a=f.multiply(f.divide(l,p[g][k]),p[g][q]);"string"===typeof a||a instanceof String?r(a):c(a);a=!0}else a=!1;if(!a)a:{a=h;if("K2"==a)c(89876E5);else if("K"==a)c(1/(3.5416E-11*Math.PI));
else if("Uo"==a)c(4E-7*Math.PI);else if("ec"==a||"elec"==a)c(1.602E-19);else if("electronMass"==a)c(9.10938356E-31);else if("protonMass"==a)c(1.6726E-27);else if("Eo"==a)c(8.854E-12);else if("error"==a)r("%perE del %perA del $perE $perA - $perA / 100 *");else{a=!1;break a}a=!0}if(!a){if(a=-1!=b.indexOf(h))a:{l=h;a=e(!0);g=e(!0);if(a.length!=g.length)if(1==g.length)k=a,a=g[0],g=k;else if(1==a.length)a=a[0];else{a=!1;break a}if("+"==l)c(f.add(g,a));else if("^"==l){a=a[0];for(l=0;l<g.length;l++)g[l]=
Math.pow(g[l],a);c(g)}else if("-"==l)c(f.subtract(g,a));else if("/"==l)c(f.divide(g,a));else if("*"==l)c(f.multiply(g,a));else if("%"==l||"mod"==l)c(f.mod(g,a));else{a=!1;break a}a=!0}if(!a){a:{a=h;if("asin"==a)c(f.asin(e(!0)));else if("acos"==a)c(f.acos(e(!0)));else if("asin"==a)c(f.acos(e(!0)));else if("dcos"==a)a=e(!0),a=f.cos(f.divide(f.multiply(a,Math.PI),180)),c(a);else if("dsin"==a)a=e(!0),a=f.sin(f.divide(f.multiply(a,Math.PI),180)),c(a);else if("dtan"==a)a=e(!0),a=f.tan(f.divide(f.multiply(a,
Math.PI),180)),c(a);else if("rcos"==a)a=e(!0),a=f.cos(a),c(a);else if("rsin"==a)a=e(!0),a=f.sin(a),c(a);else if("rtan"==a)a=e(!0),a=f.tan(a),c(a);else if("atan"==a)c(f.atan(e(!0)));else if("PI"==a)c(Math.PI);else if("e"==a||"E"==a)c(Math.E);else{a=!1;break a}a=!0}if(!(a=a||E(h)))if("seq"==h)if(a=e(!0),2<=a.length){g=1;3==a.length&&(g=a[2]);l=[];if(a[0]<a[1])for(k=a[0];k<=a[1];k+=g)l.push(k);else for(k=a[0];k>=a[1];k-=g)l.push(k);c(l);a=!0}else a=!1;else a=!1;if(!a)a:{a=h;for(g=0;g<z.length;g++)if(z[g](a)){a=
!0;break a}a=!1}if(!a)if("pop"==h||"del"==h)e();else if("@size"==h)c(m.length);else if("dup"==h)h=x(),h=JSON.parse(JSON.stringify(h)),c(h);else if("clear"==h)m=[];else if("swap"==h)h=m[m.length-1],m[m.length-1]=m[m.length-2],m[m.length-2]=h;else{a:if(a=h,-1!=a.indexOf(",")&&0!=a.indexOf(",")){a=a.split(",");g=[];for(l=0;l<a.length;l++)if(isNaN(parseFloat(a[l]))){a=!1;break a}else g.push(parseFloat(a[l]));c(g);a=!0}else a=!1;a||(isNaN(parseFloat(h))?D(h):c(parseFloat(h)))}}}}}}function E(d){if("dot"==
d)return c(f.dot(e(!0),e(!0))),!0;if("cross"==d)return c(f.cross(e(!0),e(!0))),!0;if("magnitude"==d||"mag"==d)return c(f.norm(e(!0))),!0;if("unitVector"==d)return r("dup mag /"),!0;if("dist"==d)return c(f.distance(e(!0),e(!0))),!0;if("vecGen"==d)return r("%vecd dup dcos swap dsin 2 vec *"),!0;if("at"==d){d=e();var b=e(!0);c(b[d]);return!0}if("vecAngle"==d)return r("dup mag / dup 0 at acos deg swap 1 at asin deg"),!0;if("directionCosines"==d)return r("unitVector acos"),!0;if("directionSines"==d)return r("unitVector asin"),
!0;if("multVector"==d){d=e(!0);for(var n=e(!0),h=Math.min(d.length,n.length),a=[],b=0;b<h;b++)a.push(d[b]*n[b]);c(a);return!0}if("sum"==d){d=e(!0);for(b=n=0;b<d.length;b++)n+=d[b];c(n);return!0}if("merge"==d||"union"==d||","==d)return d=e(!0),n=e(!0),c(n.concat(d)),!0;if("sort"==d)return c(f.sort(e(!0))),!0;if("uniq"==d)return c(F(e(!0))),!0;if("reverse"==d)return c(e(!0).reverse()),!0;if("mean"==d)return c(f.mean(e(!0))),!0;if("median"==d)return c(f.median(e(!0))),!0;if("mode"==d)return c(f.mode(e(!0))),
!0;if("pick"==d)return c(f.pickRandom(e(!0))),!0;if("decompose"==d){d=e(!0);for(b=0;b<d.length;b++)c(d[b]);return!0}if("std"==d)return c(f.std(e(!0))),!0;if("intersection"==d){d=e(!0);n=e(!0);a=[];for(b=0;b<d.length;b++)-1!=n.indexOf(d[b])&&(a.push(d[b]),n.splice(n.indexOf(d[b]),1));c(a);return!0}return!1}function F(b){var c={};return b.filter(function(b){return c.hasOwnProperty(b)?!1:c[b]=!0})}var p={},m=[],B={},z=[];(function(){q("dist","m");b("dist","m","meter",1);b("dist","m",["cm","centimeter"],
100);b("dist","cm",["in","inch","inches"],.3937);b("dist","in",["ft","feet"],1/12);b("dist","ft","yards",1/3);b("dist","ft",["mi","mile","miles"],1/5280);b("dist","m",["km","kilometer"],.001);b("dist","m",["mm","millimeter"],1E3);b("dist","m",["nm","nanometer"],1E9);b("dist","m",["um","micrometer"],1E6);b("dist","m",["pm","picometer"],1E12);b("dist","m",["fm","femtometer"],1E15);q("angle","rad");b("angle","rad","deg",180/Math.PI);b("angle","rad","radian",1);b("angle","deg","degree",1);b("angle","degree",
"degrees",1);b("angle","radian","radians",1);q("volume","cup");b("volume","cup",["Cup","cups","Cups"],1);b("volume","cup",["tsp","teaspoon","Teaspoon","teaspoons","Teaspoons"],48);b("volume","cup",["tbsp","tablespoon","Tablespoon","tablespoons","Tablespoons"],16);b("volume","cup",["oz","floz","OZ"],8);b("volume","cup",["pint","Pint","pints","Pints"],.5);b("volume","pint",["quart","Quart","quarts","Quarts"],.5);b("volume","quart",["gallon","Gallon","gallons","Gallons"],.25);b("volume","gallon",["liter",
"Liter","L","l"],3.78541);b("volume","liter",["mL","ml"],1E3);q("temp","F");p.temp.F="";b("temp","F","C","32 - 5 9 / *");b("temp","C","K","273.15 +");b("temp","F","R","459.67 +");q("time","s");b("time","s",["seconds","second"],1);b("time","s",["ms","millisecond","milliseconds"],1E3);b("time","s",["m","minute","minutes"],1/60);b("time","m",["h","hour","hours"],1/60);b("time","h",["d","day","days"],1/24);b("time","d",["y","year","years"],1/365);q("mass","kg");b("mass","kg","g",1E3);b("mass","kg","lbs",
1/.453592);b("mass","lbs","oz",16);b("mass","lbs",["ton","us_ton","tons"],5E-4);b("mass","kg",["tonne","metric_ton","tonnes"],.001);q("cpu","byte");t("cpu","byte","B");b("cpu","B","KiB",1/1024);b("cpu","KiB","MiB",1/1024);b("cpu","MiB","GiB",1/1024);b("cpu","GiB","TiB",1/1024);b("cpu","TiB","PiB",1/1024);b("cpu","B","KB",.001);b("cpu","KB","MB",.001);b("cpu","MB","GB",.001);b("cpu","GB","TB",.001);b("cpu","TB","PB",.001);b("cpu","B","b",8);t("cpu","b","bit");b("cpu","b","Kib",1/1024);b("cpu","Kib",
"Mib",1/1024);b("cpu","Mib","Gib",1/1024);b("cpu","Gib","Tib",1/1024);b("cpu","Tib","Pib",1/1024);b("cpu","b","Kb",.001);b("cpu","Kb","Mb",.001);b("cpu","Mb","Gb",.001);b("cpu","Gb","Tb",.001);b("cpu","Tb","Pb",.001);var c="exa peta tera giga mega kilo hecto deca deci centi milli micro nano pico femto atto".split(" "),e=[1E18,1E15,1E12,1E9,1E6,1E3,100,10,.1,.01,.001,1E-6,1E-9,1E-12,1E-15,1E-18];q("metric","none");for(var f=0;f<c.length;f++)b("metric","none",c[f],1/e[f]);b("metric","none","",1);b("metric",
"none","normal",1)})();this.parse=r;this.getStack=function(){return m};this.peeks=A;this.pop=e;this.peek=x;this.push=c;this.addExtension=function(b){z.push(b)}}"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=RPNParser);
