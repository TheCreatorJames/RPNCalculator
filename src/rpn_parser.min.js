function RPNParser(f,E){function q(k,b){r[k]={};r[k][b]=1}function b(k,c,e,f){if(e instanceof Array)for(var a=0;a<e.length;a++)b(k,c,e[a],f);else c=r[k][c],void 0!==c&&(r[k][e]="string"===typeof c||c instanceof String?c+f+" ":c*f)}function u(k,b,c){if(c instanceof Array)for(var e=0;e<c.length;e++)u(k,b,c[e]);else void 0!==r[k][b]&&(r[k][c]=r[k][b])}function e(k){return 0==p.length?0:(void 0===k?0:k)||!Array.isArray(y())?p.pop():p.pop()[0]}function B(){return 0==p.length?"":""+y()}function y(){return 0==
p.length?0:p[p.length-1]}function c(k){Array.isArray(k)||(k=[k]);p.push(k)}function z(k){return C[k]}function F(k){-1!=(""+k).indexOf(".")?(k=(""+k).split("."),k[0]=parseInt(k[0]),k[1]=parseInt(k[1]),k=[k[1],f.pow(10,(""+k[1]).length),k[0]]):k=[0,1,k];var b=f.gcd(k[0],k[1]);return[k[1]/b*k[2]+k[0]/b,k[1]/b]}function t(b){b=b.split(" ");for(var m="+ - / * % ^ mod".split(" "),n=0;n<b.length;n++){var h=b[n];if(0!=h.length)if(-1!=h.indexOf("..")){var a=parseInt(h.split("..")[0]),d=parseInt(h.split("..")[1]);
isNaN(a)&&(a=parseInt(""+z(h.split("..")[0])));isNaN(d)&&(d=parseInt(""+z(h.split("..")[1])));isNaN(a)||isNaN(d)||(c([a,d]),t("seq"))}else if(37==h.charCodeAt(0)&&1!=h.length)a=B(),h=h.substring(1),C[h]=a;else if(36==h.charCodeAt(0)&&1!=h.length)t(z(h.substring(1)));else{a:{var l=h;if("!"==l)c(f.factorial(e(!0)));else if("rand"==l){a=e(!0);for(d=0;d<a.length;d++)a[d]=Math.floor(1E5*Math.random()%a[d]);c(a)}else if("round"==l)c(f.round(e(!0)));else if("floor"==l)c(f.floor(e(!0)));else if("ceil"==l)c(f.ceil(e(!0)));
else if("lcm"==l)c(f.lcm(e(!0),e(!0)));else if("gcd"==l)c(f.gcd(e(!0),e(!0)));else if("pyth"==l)2==y().length&&t("mag");else if("abs"==l)c(f.abs(e(!0)));else if("min"==l||"max"==l||"lcm2"==l||"gcd2"==l){var a=e(!0),d=a[0],g=f.min;switch(l){case "max":g=f.max;break;case "lcm2":g=f.lcm;break;case "gcd2":g=f.gcd}for(l=1;l<a.length;l++)d=g(d,a[l]);c(d)}else if("ln"==l)c(f.log(e(!0)));else if("log"==l)c(f.log(e(!0))/f.log(10));else if("acc"==l)d=e(),a=e(!0),c(f.divide(f.round(f.multiply(a,f.pow(10,d))),
f.pow(10,d)));else{a=!1;break a}a=!0}if(!a)if(a=h.split("|"),3==a.length&&void 0!==r[a[0]]&&void 0!==r[a[0]][a[1]]&&void 0!==r[a[0]][a[2]]){var d=a[0],g=e(!0),l=a[1],q=a[2],w=r[d][l],a=r[d][q];if(void 0===w||void 0===a)a=0;else if(("string"===typeof w||w instanceof String)&&("string"===typeof a||a instanceof String)){for(var d=g+" ",g=w,l=" ",g=g.split(" "),w="+ - / * ^ % mod".split(" "),q="-;+;*;/;1 swap / ^;%;mod".split(";"),u=0,v="",x=0;x<g.length;x++)if(0!=g[x].length){var D=w.indexOf(g[x]);-1===
D?(u++,v+=g[x]+" "):(1==u?(l=v+q[D]+" "+l,v=""):v+=g[x]+" ",u--)}l=v+l;a=d+l+" "+a}else a=f.multiply(f.divide(g,r[d][l]),r[d][q]);"string"===typeof a||a instanceof String?t(a):c(a);a=!0}else a=!1;if(!a)a:{a=h;if("K2"==a)c(89876E5);else if("K"==a)c(1/(3.5416E-11*Math.PI));else if("Uo"==a)c(4E-7*Math.PI);else if("ec"==a||"elec"==a)c(1.602E-19);else if("electronMass"==a)c(9.10938356E-31);else if("protonMass"==a)c(1.6726E-27);else if("Eo"==a)c(8.854E-12);else if("error"==a)t("%perE del %perA del $perE $perA - $perA / 100 *");
else{a=!1;break a}a=!0}if(!a){if(a=-1!=m.indexOf(h))a:{g=h;a=e(!0);d=e(!0);if(a.length!=d.length)if(1==d.length)l=a,a=d[0],d=l;else if(1==a.length)a=a[0];else{a=!1;break a}if("+"==g)c(f.add(d,a));else if("^"==g){a=a[0];for(g=0;g<d.length;g++)d[g]=Math.pow(d[g],a);c(d)}else if("-"==g)c(f.subtract(d,a));else if("/"==g)c(f.divide(d,a));else if("*"==g)c(f.multiply(d,a));else if("%"==g||"mod"==g)c(f.mod(d,a));else{a=!1;break a}a=!0}if(!a){a:{a=h;if("asin"==a)c(f.asin(e(!0)));else if("acos"==a)c(f.acos(e(!0)));
else if("asin"==a)c(f.acos(e(!0)));else if("dcos"==a)a=e(!0),a=f.cos(f.divide(f.multiply(a,Math.PI),180)),c(a);else if("dsin"==a)a=e(!0),a=f.sin(f.divide(f.multiply(a,Math.PI),180)),c(a);else if("dtan"==a)a=e(!0),a=f.tan(f.divide(f.multiply(a,Math.PI),180)),c(a);else if("rcos"==a)a=e(!0),a=f.cos(a),c(a);else if("rsin"==a)a=e(!0),a=f.sin(a),c(a);else if("rtan"==a)a=e(!0),a=f.tan(a),c(a);else if("atan"==a)c(f.atan(e(!0)));else if("PI"==a)c(Math.PI);else if("e"==a||"E"==a)c(Math.E);else{a=!1;break a}a=
!0}if(!(a=a||G(h)))a:{a=h;if("frac"==a||"fraction"==a){a=e(!0);d=[];for(g=0;g<a.length;g++)d=d.concat(F(a[g]));c(d)}else if("seq"==a)if(a=e(!0),2<=a.length){d=1;3==a.length&&(d=a[2]);l=[];if(a[0]<a[1])for(g=a[0];g<=a[1];g+=d)l.push(g);else for(g=a[0];g>=a[1];g-=d)l.push(g);c(l)}else{a=!1;break a}else if("combination"==a||"nCr"==a||"comb"==a)a=e(!0),c(f.combinations(a[0],a[1]));else if("permutation"==a||"perm"==a||"nPr"==a)a=e(!0),c(f.permutations(a[0],a[1]));else if("multinomial"==a)a=e(!0),c(f.multinomial(a));
else if("sigfig"==a||"sig"==a||"sig_fig"==a)a=e(!0),d=[0,1],a=a[0].toPrecision(a[1]).split("e"),1!=a.length&&(d[1]=parseFloat(a[1])),d[0]=parseFloat(a[0]),c(d);else{a=!1;break a}a=!0}if(!a)a:{a=h;for(d=0;d<A.length;d++)if(A[d](a)){a=!0;break a}a=!1}if(!a)if("pop"==h||"del"==h)e();else if("@size"==h)c(p.length);else if("dup"==h)h=y(),h=JSON.parse(JSON.stringify(h)),c(h);else if("clear"==h)h=p,p=[],delete h;else if("swap"==h)h=p[p.length-1],p[p.length-1]=p[p.length-2],p[p.length-2]=h;else{a:if(a=h,
-1!=a.indexOf(",")&&0!=a.indexOf(",")){a=a.split(",");d=[];for(g=0;g<a.length;g++)if(isNaN(parseFloat(a[g]))){a=!1;break a}else d.push(parseFloat(a[g]));c(d);a=!0}else a=!1;a||(isNaN(parseFloat(h))?E(h):c(parseFloat(h)))}}}}}}function G(b){if("dot"==b)return c(f.dot(e(!0),e(!0))),!0;if("cross"==b)return c(f.cross(e(!0),e(!0))),!0;if("magnitude"==b||"mag"==b)return c(f.norm(e(!0))),!0;if("unitVector"==b)return t("dup mag /"),!0;if("dist"==b)return c(f.distance(e(!0),e(!0))),!0;if("vecGen"==b)return t("%vecd dup dcos swap dsin 2 vec *"),
!0;if("at"==b){b=e();var m=e(!0);c(m[b]);return!0}if("vecAngle"==b)return t("dup mag / dup 0 at acos deg swap 1 at asin deg"),!0;if("directionCosines"==b)return t("unitVector acos"),!0;if("directionSines"==b)return t("unitVector asin"),!0;if("multVector"==b||"divVector"==b){for(var n=e(!0),m=e(!0),h=Math.min(m.length,n.length),a=[],d=0;d<h;d++)"multVector"==b?a.push(m[d]*n[d]):a.push(m[d]/n[d]);c(a);return!0}if("sum"==b||"product"==b){m=e(!0);for(d=n=0;d<m.length;d++)"sum"==b?n+=m[d]:(0==d&&(n=1),
n*=m[d]);c(n);return!0}if("merge"==b||"union"==b||","==b)return m=e(!0),n=e(!0),c(n.concat(m)),!0;if("sort"==b)return c(f.sort(e(!0))),!0;if("uniq"==b)return c(H(e(!0))),!0;if("reverse"==b)return c(e(!0).reverse()),!0;if("mean"==b)return c(f.mean(e(!0))),!0;if("median"==b)return c(f.median(e(!0))),!0;if("mode"==b)return c(f.mode(e(!0))),!0;if("pick"==b)return c(f.pickRandom(e(!0))),!0;if("decompose"==b){m=e(!0);for(d=0;d<m.length;d++)c(m[d]);return!0}if("std"==b)return c(f.std(e(!0))),!0;if("intersection"==
b){m=e(!0);n=e(!0);a=[];for(d=0;d<m.length;d++)-1!=n.indexOf(m[d])&&(a.push(m[d]),n.splice(n.indexOf(m[d]),1));c(a);return!0}if("diff"==b){n=e(!0);m=e(!0);for(d=0;d<n.length;d++)-1!=m.indexOf(n[d])&&m.splice(m.indexOf(n[d]),1);c(m);return!0}return"udiff"==b?(t("%b pop %a $b diff $b $a diff union"),!0):!1}function H(b){var c={};return b.filter(function(b){return c.hasOwnProperty(b)?!1:c[b]=!0})}var r={},p=[],C={},A=[];(function(){q("dist","m");b("dist","m","meter",1);b("dist","m",["cm","centimeter",
"centimeters"],100);b("dist","cm",["in","inch","inches"],.3937);b("dist","in",["ft","feet"],1/12);b("dist","ft",["yd","yards"],1/3);b("dist","ft",["mi","mile","miles"],1/5280);b("dist","m",["km","kilometer","kilometers"],.001);b("dist","m",["mm","millimeter","millimeters"],1E3);b("dist","m",["nm","nanometer","nanometers"],1E9);b("dist","m",["um","micrometer","micrometers"],1E6);b("dist","m",["pm","picometer","micrometers"],1E12);b("dist","m",["fm","femtometer","femtometers"],1E15);b("dist","m",["nautical_mile",
"Nautical-Mile","Nautical_Mile","nautical-mile"],1/1852);q("angle","rad");b("angle","rad","deg",180/Math.PI);b("angle","rad","radian",1);b("angle","deg","degree",1);b("angle","degree","degrees",1);b("angle","radian","radians",1);q("volume","cup");b("volume","cup",["Cup","cups","Cups"],1);b("volume","cup",["tsp","teaspoon","Teaspoon","teaspoons","Teaspoons"],48);b("volume","cup",["tbsp","tablespoon","Tablespoon","tablespoons","Tablespoons"],16);b("volume","cup",["oz","floz","OZ"],8);b("volume","cup",
["pint","Pint","pints","Pints"],.5);b("volume","pint",["quart","Quart","quarts","Quarts"],.5);b("volume","quart","gallon Gallon gallons Gallons gal Gal".split(" "),.25);b("volume","gallon",["liter","Liter","L","l"],3.78541);b("volume","liter",["mL","ml"],1E3);b("volume","liter",["cubic_m","m^3","cubic_meter","cubic_meters"],.001);b("volume","mL",["cm^3","cubic_centimeter","cubic_centimeters","cubic_cm"],1);b("volume","mL",["in^3","cubic_inch","cubic_in","cubic_inches"],.0610237);b("volume","in^3",
["ft^3","cubic_feet","cubic_foot","cubic_ft"],1/1728);q("temp","F");r.temp.F="";b("temp","F","C","32 - 5 9 / *");b("temp","C","K","273.15 +");b("temp","F","R","459.67 +");q("time","s");b("time","s",["seconds","second"],1);b("time","s",["ms","millisecond","milliseconds","Millisecond","Milliseconds"],1E3);b("time","s",["m","minute","minutes","Minute","Minutes"],1/60);b("time","m",["h","hour","hours","Hour","Hours"],1/60);b("time","h",["d","day","days","Day","Days"],1/24);b("time","d",["y","year","years",
"Years","Year"],1/365);b("time","y",["decade","Decade","Decades","decades"],.1);b("time","decade",["century","Century","centuries","Centuries"],.1);q("mass","kg");b("mass","kg","g",1E3);b("mass","kg",["kilogram","Kilogram","KG"],1);b("mass","kg","lbs",1/.453592);b("mass","lbs","pounds pound Pound Pounds lb lbm".split(" "),1);b("mass","lbs","oz",16);b("mass","lbs",["ton","us_ton","tons"],5E-4);b("mass","kg",["tonne","metric_ton","tonnes"],.001);q("force","N");b("force","N",["Newton","newton"],1);b("force",
"N",["lbs","lbf","pound","Pound"],.224809);q("energy","J");b("energy","J",["Joule","joule"],1);b("energy","J",["cal","calorie","Gram-Calorie"],.239006);b("energy","cal",["Cal","Calorie","Food-Calorie","Kilocalorie"],.001);b("energy","J",["KJ","Kilojoule","kilojoule"],.001);b("energy","J",["BTU","BritishThermalUnit"],9.47817E-4);q("cpu","byte");u("cpu","byte","B");b("cpu","B","KiB",1/1024);b("cpu","KiB","MiB",1/1024);b("cpu","MiB","GiB",1/1024);b("cpu","GiB","TiB",1/1024);b("cpu","TiB","PiB",1/1024);
b("cpu","B","KB",.001);b("cpu","KB","MB",.001);b("cpu","MB","GB",.001);b("cpu","GB","TB",.001);b("cpu","TB","PB",.001);b("cpu","B","b",8);u("cpu","b","bit");b("cpu","b","Kib",1/1024);b("cpu","Kib","Mib",1/1024);b("cpu","Mib","Gib",1/1024);b("cpu","Gib","Tib",1/1024);b("cpu","Tib","Pib",1/1024);b("cpu","b","Kb",.001);b("cpu","Kb","Mb",.001);b("cpu","Mb","Gb",.001);b("cpu","Gb","Tb",.001);b("cpu","Tb","Pb",.001);var c="exa peta tera giga mega kilo hecto deca deci centi milli micro nano pico femto atto".split(" "),
e=[1E18,1E15,1E12,1E9,1E6,1E3,100,10,.1,.01,.001,1E-6,1E-9,1E-12,1E-15,1E-18];q("metric","none");for(var f=0;f<c.length;f++)b("metric","none",c[f],1/e[f]);b("metric","none","",1);b("metric","none","normal",1)})();this.parse=t;this.getStack=function(){return p};this.peeks=B;this.pop=e;this.peek=y;this.push=c;this.addExtension=function(b){A.push(b)}}"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=RPNParser);
