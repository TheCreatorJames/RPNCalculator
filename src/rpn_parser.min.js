function RPNParser(h,C){function t(g,b){q[g]={};q[g][b]=1}function w(g,l,c,f,a){l=Object.keys(q[l]);var e=a(f,f);b(g,c,e[0],1);for(var d=0;d<l.length;d++)l[d]!=f&&(e=a(f,l[d]),b(g,c,e[0],e[1]))}function b(g,c,d,f){if(d instanceof Array)for(var a=0;a<d.length;a++)b(g,c,d[a],f);else c=q[g][c],void 0!==c&&(q[g][d]="string"===typeof c||c instanceof String?c+f+" ":c*f)}function x(g,b,c){if(c instanceof Array)for(var f=0;f<c.length;f++)x(g,b,c[f]);else void 0!==q[g][b]&&(q[g][c]=q[g][b])}function v(g,b,
c,f){var a=q[g][c],e=q[g][f];if(void 0===a||void 0===e)return 0;if(("string"===typeof a||a instanceof String)&&("string"===typeof e||e instanceof String)){g=" ";a=a.split(" ");c="+ - / * ^ % mod".split(" ");f="-;+;*;/;1 swap / ^;%;mod".split(";");for(var d=0,k="",n=0;n<a.length;n++)if(0!=a[n].length){var r=c.indexOf(a[n]);-1===r?(d++,k+=a[n]+" "):(1==d?(g=k+f[r]+" "+g,k=""):k+=a[n]+" ",d--)}return b+" "+(k+g)+" "+e}return h.multiply(h.divide(b,q[g][c]),q[g][f])}function d(g){return 0==n.length?0:
(void 0===g?0:g)||!Array.isArray(u())?n.pop():n.pop()[0]}function A(){return 0==n.length?"":""+u()}function u(){return 0==n.length?0:n[n.length-1]}function c(g){Array.isArray(g)||(g=[g]);n.push(g)}function y(g){return B[g]}function D(g){-1!=(""+g).indexOf(".")?(g=(""+g).split("."),g[0]=parseInt(g[0]),g[1]=parseInt(g[1]),g=[g[1],h.pow(10,(""+g[1]).length),g[0]]):g=[0,1,g];var b=h.gcd(g[0],g[1]);return[g[1]/b*g[2]+g[0]/b,g[1]/b]}function r(g){g=g.split(" ");for(var b="+ - / * % ^ mod".split(" "),p=
0;p<g.length;p++){var f=g[p];if(0!=f.length)if(-1!=f.indexOf("..")){var a=parseInt(f.split("..")[0]),e=parseInt(f.split("..")[1]);isNaN(a)&&(a=parseInt(""+y(f.split("..")[0])));isNaN(e)&&(e=parseInt(""+y(f.split("..")[1])));isNaN(a)||isNaN(e)||(c([a,e]),r("seq"))}else if(37==f.charCodeAt(0)&&1!=f.length)a=A(),f=f.substring(1),B[f]=a;else if(36==f.charCodeAt(0)&&1!=f.length)r(y(f.substring(1)));else{a:{var m=f;if("!"==m)c(h.factorial(d(!0)));else if("rand"==m){a=d(!0);for(e=0;e<a.length;e++)a[e]=Math.floor(1E5*
Math.random()%a[e]);c(a)}else if("round"==m)c(h.round(d(!0)));else if("floor"==m)c(h.floor(d(!0)));else if("ceil"==m)c(h.ceil(d(!0)));else if("lcm"==m)c(h.lcm(d(!0),d(!0)));else if("gcd"==m)c(h.gcd(d(!0),d(!0)));else if("pyth"==m)2==u().length&&r("mag");else if("abs"==m)c(h.abs(d(!0)));else if("min"==m||"max"==m||"lcm2"==m||"gcd2"==m){var a=d(!0),e=a[0],k=h.min;switch(m){case "max":k=h.max;break;case "lcm2":k=h.lcm;break;case "gcd2":k=h.gcd}for(m=1;m<a.length;m++)e=k(e,a[m]);c(e)}else if("ln"==m)c(h.log(d(!0)));
else if("log"==m)c(h.log(d(!0))/h.log(10));else if("acc"==m)e=d(),a=d(!0),c(h.divide(h.round(h.multiply(a,h.pow(10,e))),h.pow(10,e)));else{a=!1;break a}a=!0}a||(a=f.split("|"),3==a.length&&void 0!==q[a[0]]&&void 0!==q[a[0]][a[1]]&&void 0!==q[a[0]][a[2]]?(a=v(a[0],d(!0),a[1],a[2]),"string"===typeof a||a instanceof String?r(a):c(a),a=!0):a=!1);if(!a)a:{a=f;if("K2"==a)c(89876E5);else if("K"==a)c(1/(3.5416E-11*Math.PI));else if("Uo"==a)c(4E-7*Math.PI);else if("ec"==a||"elec"==a)c(1.602E-19);else if("electronMass"==
a)c(9.10938356E-31);else if("protonMass"==a)c(1.6726E-27);else if("Eo"==a)c(8.854E-12);else if("error"==a)r("%perE del %perA del $perE $perA - $perA / 100 *");else{a=!1;break a}a=!0}a||("avogadro"==f.toLowerCase()?(c(6.0221409E23),a=!0):a=!1);if(!a){if(a=-1!=b.indexOf(f))a:{k=f;a=d(!0);e=d(!0);if(a.length!=e.length)if(1==e.length)m=a,a=e[0],e=m;else if(1==a.length)a=a[0];else{a=!1;break a}if("+"==k)c(h.add(e,a));else if("^"==k){a=a[0];for(k=0;k<e.length;k++)e[k]=Math.pow(e[k],a);c(e)}else if("-"==
k)c(h.subtract(e,a));else if("/"==k)c(h.divide(e,a));else if("*"==k)c(h.multiply(e,a));else if("%"==k||"mod"==k)c(h.mod(e,a));else{a=!1;break a}a=!0}if(!a){a:{a=f;if("asin"==a)c(h.asin(d(!0)));else if("acos"==a)c(h.acos(d(!0)));else if("asin"==a)c(h.acos(d(!0)));else if("dcos"==a)a=d(!0),a=h.cos(h.divide(h.multiply(a,Math.PI),180)),c(a);else if("dsin"==a)a=d(!0),a=h.sin(h.divide(h.multiply(a,Math.PI),180)),c(a);else if("dtan"==a)a=d(!0),a=h.tan(h.divide(h.multiply(a,Math.PI),180)),c(a);else if("rcos"==
a)a=d(!0),a=h.cos(a),c(a);else if("rsin"==a)a=d(!0),a=h.sin(a),c(a);else if("rtan"==a)a=d(!0),a=h.tan(a),c(a);else if("atan"==a)c(h.atan(d(!0)));else if("PI"==a)c(Math.PI);else if("e"==a||"E"==a)c(Math.E);else{a=!1;break a}a=!0}if(!(a=a||E(f)))a:{a=f;if("frac"==a||"fraction"==a){a=d(!0);e=[];for(k=0;k<a.length;k++)e=e.concat(D(a[k]));c(e)}else if("seq"==a)if(a=d(!0),2<=a.length){e=1;3==a.length&&(e=a[2]);m=[];if(a[0]<a[1])for(k=a[0];k<=a[1];k+=e)m.push(k);else for(k=a[0];k>=a[1];k-=e)m.push(k);c(m)}else{a=
!1;break a}else if("combination"==a||"nCr"==a||"comb"==a)a=d(!0),c(h.combinations(a[0],a[1]));else if("permutation"==a||"perm"==a||"nPr"==a)a=d(!0),c(h.permutations(a[0],a[1]));else if("multinomial"==a)a=d(!0),c(h.multinomial(a));else if("sigfig"==a||"sig"==a||"sig_fig"==a)a=d(!0),e=[0,1],a=a[0].toPrecision(a[1]).split("e"),1!=a.length&&(e[1]=parseFloat(a[1])),e[0]=parseFloat(a[0]),c(e);else{a=!1;break a}a=!0}if(!a)a:{a=f;for(e=0;e<z.length;e++)if(z[e](a)){a=!0;break a}a=!1}if(!a)if("pop"==f||"del"==
f)d();else if("@size"==f)c(n.length);else if("dup"==f)f=u(),f=JSON.parse(JSON.stringify(f)),c(f);else if("clear"==f)f=n,n=[],delete f;else if("swap"==f)f=n[n.length-1],n[n.length-1]=n[n.length-2],n[n.length-2]=f;else{a:if(a=f,-1!=a.indexOf(",")&&0!=a.indexOf(",")){a=a.split(",");e=[];for(k=0;k<a.length;k++)if(isNaN(parseFloat(a[k]))){a=!1;break a}else e.push(parseFloat(a[k]));c(e);a=!0}else a=!1;a||(isNaN(parseFloat(f))?C(f):c(parseFloat(f)))}}}}}}function E(b){if("dot"==b)return c(h.dot(d(!0),d(!0))),
!0;if("cross"==b)return c(h.cross(d(!0),d(!0))),!0;if("magnitude"==b||"mag"==b)return c(h.norm(d(!0))),!0;if("unitVector"==b)return r("dup mag /"),!0;if("dist"==b)return c(h.distance(d(!0),d(!0))),!0;if("vecGen"==b)return r("%vecd dup dcos swap dsin 2 vec *"),!0;if("at"==b){b=d();var l=d(!0);c(l[b]);return!0}if("vecAngle"==b)return r("dup mag / dup 0 at acos deg swap 1 at asin deg"),!0;if("directionCosines"==b)return r("unitVector acos"),!0;if("directionSines"==b)return r("unitVector asin"),!0;if("multVector"==
b||"divVector"==b){for(var p=d(!0),l=d(!0),f=Math.min(l.length,p.length),a=[],e=0;e<f;e++)"multVector"==b?a.push(l[e]*p[e]):a.push(l[e]/p[e]);c(a);return!0}if("sum"==b||"product"==b){l=d(!0);for(e=p=0;e<l.length;e++)"sum"==b?p+=l[e]:(0==e&&(p=1),p*=l[e]);c(p);return!0}if("merge"==b||"union"==b||","==b)return l=d(!0),p=d(!0),c(p.concat(l)),!0;if("sort"==b)return c(h.sort(d(!0))),!0;if("uniq"==b)return c(F(d(!0))),!0;if("reverse"==b)return c(d(!0).reverse()),!0;if("mean"==b)return c(h.mean(d(!0))),
!0;if("median"==b)return c(h.median(d(!0))),!0;if("mode"==b)return c(h.mode(d(!0))),!0;if("pick"==b)return c(h.pickRandom(d(!0))),!0;if("decompose"==b){l=d(!0);for(e=0;e<l.length;e++)c(l[e]);return!0}if("std"==b)return c(h.std(d(!0))),!0;if("intersection"==b){l=d(!0);p=d(!0);a=[];for(e=0;e<l.length;e++)-1!=p.indexOf(l[e])&&(a.push(l[e]),p.splice(p.indexOf(l[e]),1));c(a);return!0}if("diff"==b){p=d(!0);l=d(!0);for(e=0;e<p.length;e++)-1!=l.indexOf(p[e])&&l.splice(l.indexOf(p[e]),1);c(l);return!0}return"udiff"==
b?(r("%b pop %a $b diff $b $a diff union"),!0):!1}function F(b){var c={};return b.filter(function(b){return c.hasOwnProperty(b)?!1:c[b]=!0})}var q={},n=[],B={},z=[];(function(){function c(d,g,f){b(d,"kilo"+g,"k"+f,1);b(d,"centi"+g,"c"+f,1);b(d,"milli"+g,"m"+f,1);b(d,"nano"+g,"n"+f,1);b(d,"micro"+g,"u"+f,1);b(d,"pico"+g,"p"+f,1);b(d,"femto"+g,"f"+f,1)}(function(c,d){t("metric","none");for(var f=0;f<c.length;f++)b("metric","none",c[f],1/d[f]);b("metric","none","",1);b("metric","none","normal",1)})("exa peta tera giga mega kilo hecto deca deci centi milli micro nano pico femto atto".split(" "),
[1E18,1E15,1E12,1E9,1E6,1E3,100,10,.1,.01,.001,1E-6,1E-9,1E-12,1E-15,1E-18]);t("dist","m");b("dist","m","meter",1);w("dist","metric","m","",function(b,c){var d=v("metric",1,b,c);return[[c+"meter",c+"meters"],d]});c("dist","meter","m");b("dist","cm",["in","inch","inches"],.3937);b("dist","in",["ft","feet"],1/12);b("dist","ft",["yd","yards"],1/3);b("dist","ft",["mi","mile","miles"],1/5280);b("dist","m",["nautical_mile","Nautical-Mile","Nautical_Mile","nautical-mile"],1/1852);t("angle","rad");b("angle",
"rad","deg",180/Math.PI);b("angle","rad","radian",1);b("angle","deg","degree",1);b("angle","degree","degrees",1);b("angle","radian","radians",1);t("volume","cup");b("volume","cup",["Cup","cups","Cups"],1);b("volume","cup",["tsp","teaspoon","Teaspoon","teaspoons","Teaspoons"],48);b("volume","cup",["tbsp","tablespoon","Tablespoon","tablespoons","Tablespoons"],16);b("volume","cup",["oz","floz","OZ"],8);b("volume","cup",["pint","Pint","pints","Pints"],.5);b("volume","pint",["quart","Quart","quarts","Quarts"],
.5);b("volume","quart","gallon Gallon gallons Gallons gal Gal".split(" "),.25);b("volume","gallon",["liter","Liter","L","l"],3.78541);b("volume","liter",["mL","ml"],1E3);b("volume","liter",["cubic_m","m^3","cubic_meter","cubic_meters"],.001);w("volume","dist","mL","cm",function(b,c){var d=v("dist",1,b,c),d=Math.pow(d,3);return[c+"^3",d]});t("temp","F");q.temp.F="";b("temp","F","C","32 - 5 9 / *");b("temp","C","K","273.15 +");b("temp","F","R","459.67 +");t("pressure","atm");b("pressure","atm",["Atmosphere",
"atmosphere","atmospheres","Atmospheres"],1);b("pressure","atm","bar",1.01325);b("pressure","atm",["pa","Pa","Pascals","Pascal"],101325);b("pressure","atm","psi",14.6959);t("time","s");b("time","s",["seconds","second"],1);b("time","s",["ms","millisecond","milliseconds","Millisecond","Milliseconds"],1E3);b("time","s",["m","minute","minutes","Minute","Minutes"],1/60);b("time","m",["h","hour","hours","Hour","Hours"],1/60);b("time","h",["d","day","days","Day","Days"],1/24);b("time","d",["y","year","years",
"Years","Year"],1/365);b("time","y",["decade","Decade","Decades","decades"],.1);b("time","decade",["century","Century","centuries","Centuries"],.1);t("mass","kg");b("mass","kg","g",1E3);w("mass","metric","g","",function(b,c){var d=v("metric",1,b,c);return[[c+"gram",c+"grams"],d]});c("mass","gram","g");b("mass","g","amu",1/1.66054E-24);b("mass","kg","lbs",1/.453592);b("mass","lbs","slug",1/32.174);b("mass","lbs","pounds pound Pound Pounds lb lbm".split(" "),1);b("mass","lbs","oz",16);b("mass","lbs",
["ton","us_ton","tons"],5E-4);b("mass","kg",["tonne","metric_ton","tonnes"],.001);t("force","N");b("force","N",["Newton","newton"],1);b("force","N",["lbs","lbf","pound","Pound"],.224809);t("energy","J");b("energy","J",["Joule","joule"],1);b("energy","J",["cal","calorie","Gram-Calorie"],.239006);b("energy","cal",["Cal","Calorie","Food-Calorie","Kilocalorie"],.001);b("energy","J",["KJ","Kilojoule","kilojoule"],.001);b("energy","J",["BTU","BritishThermalUnit"],9.47817E-4);t("cpu","byte");x("cpu","byte",
"B");b("cpu","B","KiB",1/1024);b("cpu","KiB","MiB",1/1024);b("cpu","MiB","GiB",1/1024);b("cpu","GiB","TiB",1/1024);b("cpu","TiB","PiB",1/1024);b("cpu","B","KB",.001);b("cpu","KB","MB",.001);b("cpu","MB","GB",.001);b("cpu","GB","TB",.001);b("cpu","TB","PB",.001);b("cpu","B","b",8);x("cpu","b","bit");b("cpu","b","Kib",1/1024);b("cpu","Kib","Mib",1/1024);b("cpu","Mib","Gib",1/1024);b("cpu","Gib","Tib",1/1024);b("cpu","Tib","Pib",1/1024);b("cpu","b","Kb",.001);b("cpu","Kb","Mb",.001);b("cpu","Mb","Gb",
.001);b("cpu","Gb","Tb",.001);b("cpu","Tb","Pb",.001)})();this.parse=r;this.getStack=function(){return n};this.peeks=A;this.pop=d;this.peek=u;this.push=c;this.addExtension=function(b){z.push(b)}}"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=RPNParser);
